<ion-list>
  @for (set of sets(); track set; let i = $index) {
    @let id = getRandomId();
    <ion-item [button]="true" [id]="id">
      <ion-icon color="danger" slot="start" name="list-circle" size="large"></ion-icon>
      <ion-label>
        <h3>Set #{{ i+1 }}</h3>
        @if (set.reps && set.weight) {
          <p>{{set.reps}} Reps &#64; {{set.weight}} {{set.unit}}</p>
        }
        @if (set.reps && !set.weight) {
          <p>{{set.reps}} Reps</p>
        }
        @if (!set.reps && set.weight) {
          <p>{{set.weight}} {{set.unit}}</p>
        }
      </ion-label>
      @switch (set.kind) {
        @case ('warm-up') {
          <ion-badge>Warm-up</ion-badge>
        }
        @case ('drop-set') {
          <ion-badge>Drop Set</ion-badge>
        }
        @case ('failure') {
          <ion-badge color="danger">Failure</ion-badge>
        }
      }
    </ion-item>
    <ion-modal [trigger]="id" (willPresent)="initModal(i)" #modal>
      <ng-template>
        <ion-header>
          <ion-toolbar>
            <ion-buttons slot="start">
              <ion-button (click)="cancel(i)">Cancel</ion-button>
            </ion-buttons>
            <ion-title>Update Set #{{ i+1 }}</ion-title>
            <ion-buttons slot="end">
              <ion-button (click)="confirm(i)" [strong]="true">Confirm</ion-button>
            </ion-buttons>
          </ion-toolbar>
        </ion-header>
        <ion-content class="ion-padding">
          @let updatedSet = editedSet();
          @if (updatedSet) {
          <ion-item>
            <ion-select label="Type" [(ngModel)]="updatedSet.kind">
              <ion-select-option value="warm-up">Warm Up</ion-select-option>
              <ion-select-option value="normal">Normal</ion-select-option>
              <ion-select-option value="drop-set">Drop Set</ion-select-option>
              <ion-select-option value="failure">Failure</ion-select-option>
            </ion-select>
          </ion-item>
          <ion-item>
            <ion-input label="Reps" type="number" min="0" [(ngModel)]="updatedSet.reps" />
          </ion-item>
          <ion-item>
            <ion-input label="Weight" type="number" min="0" [(ngModel)]="updatedSet.weight" />
          </ion-item>
          <ion-item>
            <ion-select label="Unit" [(ngModel)]="updatedSet.unit">
              <ion-select-option value="lb">Pounds</ion-select-option>
              <ion-select-option value="kg">Kilos</ion-select-option>
            </ion-select>
          </ion-item>
          }
        </ion-content>
      </ng-template>
    </ion-modal>
  }
  <ion-item [button]="true">
    <ion-icon aria-hidden="true" name="add" slot="start"></ion-icon>
    <ion-label>Add Set</ion-label>
  </ion-item>
</ion-list>
