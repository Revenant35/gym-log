<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-button (click)="cancelWorkout()">
        <ion-icon slot="icon-only" name="close-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
    <ion-title>{{ workoutName() }}</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="completeWorkout()" [disabled]="!canCompleteWorkout()">
        <ion-icon slot="icon-only" name="checkmark-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>

  <app-workout-session-progress-bar
    [totalExercises]="totalExercises()"
    [completedExercises]="completedExercises()"
    [totalSets]="totalSets()"
    [completedSets]="completedSets()"
    [duration]="workoutDuration()"/>
</ion-header>

<ion-content>
  @if (isWorkoutComplete()) {
    <div class="workout-complete">
      <ion-icon name="checkmark-circle" color="success" class="complete-icon"></ion-icon>
      <h2>Workout Complete!</h2>
      <p>Great job! Your workout has been logged.</p>
    </div>
  } @else {
    <div class="session-container">
      @for (log of exerciseLogs(); track $index) {
        <app-exercise-logging-card
          [log]="log"
          (logChange)="updateLog($index, $event)"
          [isExpanded]="$first"
        />
      }
    </div>
  }
</ion-content>

@if (!isWorkoutComplete()) {
  <ion-footer>
    <ion-toolbar>
      <ion-button
        expand="block"
        size="large"
        (click)="completeWorkout()"
        [disabled]="!canCompleteWorkout()"
      >
        <ion-icon slot="start" name="checkmark-circle-outline"></ion-icon>
        Complete Workout
      </ion-button>
    </ion-toolbar>
  </ion-footer>
}
